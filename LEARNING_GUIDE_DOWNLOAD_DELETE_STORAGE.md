# SeaweedFS ä¸‹è½½ã€åˆ é™¤å’Œå­˜å‚¨å¼•æ“è¯¦è§£

æœ¬æ–‡æ¡£æ·±å…¥è§£æ SeaweedFS çš„æ–‡ä»¶ä¸‹è½½ã€åˆ é™¤æµç¨‹ä»¥åŠå­˜å‚¨å¼•æ“çš„æ ¸å¿ƒå®ç°ã€‚

---

## ğŸ“¥ æ–‡ä»¶ä¸‹è½½æµç¨‹è¯¦è§£

### æ ¸å¿ƒå¤„ç†å‡½æ•°

**æ–‡ä»¶ä½ç½®ï¼š** `weed/server/volume_server_handlers_read.go`

#### 1. `GetOrHeadHandler()` - ä¸‹è½½è¯·æ±‚çš„ä¸»å¤„ç†å‡½æ•°

```go
// GetOrHeadHandler å¤„ç† GET å’Œ HEAD è¯·æ±‚ï¼ˆæ–‡ä»¶ä¸‹è½½ï¼‰
// API ç¤ºä¾‹ï¼š
//   curl "http://localhost:8080/3,01e3b0756f" -o file.dat
//
// åŠŸèƒ½æµç¨‹ï¼š
// 1. è§£æ URL è·¯å¾„ï¼Œæå– vidã€fid
// 2. æ£€æŸ¥ JWT è®¤è¯ï¼ˆå¦‚æœå¯ç”¨ï¼‰
// 3. æ£€æŸ¥æœ¬åœ°æ˜¯å¦æœ‰è¯¥å·
// 4. å¦‚æœæ²¡æœ‰ï¼Œæ ¹æ® ReadMode å¤„ç†ï¼ˆproxy/redirect/localï¼‰
// 5. ä»å­˜å‚¨å¼•æ“è¯»å– Needle
// 6. è®¾ç½® HTTP å“åº”å¤´ï¼ˆContent-Type, Last-Modified, ETag ç­‰ï¼‰
// 7. è¿”å›æ–‡ä»¶æ•°æ®ç»™å®¢æˆ·ç«¯
func (vs *VolumeServer) GetOrHeadHandler(w http.ResponseWriter, r *http.Request)
```

**å…³é”®æ­¥éª¤è¯¦è§£ï¼š**

```go
// æ­¥éª¤ 1: è§£æ URL è·¯å¾„
n := new(needle.Needle)  // åˆ›å»º Needle å¯¹è±¡ç”¨äºå­˜å‚¨æ–‡ä»¶æ•°æ®
vid, fid, filename, ext, _ := parseURLPath(r.URL.Path)
// ä¾‹å¦‚ï¼š"/3,01e3b0756f.jpg"
//   -> vid="3", fid="01e3b0756f", ext=".jpg"

// æ­¥éª¤ 2: åˆ›å»ºå· ID å¯¹è±¡
volumeId, err := needle.NewVolumeId(vid)

// æ­¥éª¤ 3: è§£ææ–‡ä»¶ IDï¼ˆfidï¼‰ä¸º Needle çš„å†…éƒ¨è¡¨ç¤º
err = n.ParsePath(fid)
// ParsePath ä¼šè§£æå‡ºï¼š
//   - NeedleId: æ–‡ä»¶çš„å”¯ä¸€æ ‡è¯†
//   - Cookie: å®‰å…¨éªŒè¯ç 

// æ­¥éª¤ 4: æ£€æŸ¥æœ¬åœ°æ˜¯å¦æœ‰è¯¥å·
hasVolume := vs.store.HasVolume(volumeId)        // æ™®é€šå·
_, hasEcVolume := vs.store.FindEcVolume(volumeId) // ECå·ï¼ˆçº åˆ ç ï¼‰

// æ­¥éª¤ 5: å¦‚æœæœ¬åœ°æ²¡æœ‰ï¼Œæ ¹æ® ReadMode å¤„ç†
if !hasVolume && !hasEcVolume {
    if vs.ReadMode == "local" {
        // local æ¨¡å¼ï¼šåªè¯»æœ¬åœ°å·ï¼Œè¿”å› 404
        NotFound(w)
        return
    }
    // proxy/redirect æ¨¡å¼ï¼šè½¬å‘åˆ°æ‹¥æœ‰è¯¥å·çš„ Volume Server
    vs.proxyReqToTargetServer(w, r)
    return
}

// æ­¥éª¤ 6: ä»å­˜å‚¨è¯»å– Needle
readOption := &storage.ReadOption{
    ReadDeleted:    r.FormValue("readDeleted") == "true", // æ˜¯å¦è¯»å–å·²åˆ é™¤æ–‡ä»¶
    HasSlowRead:    vs.hasSlowRead,     // æ˜¯å¦å¯ç”¨æ…¢è¯»ä¼˜åŒ–
    ReadBufferSize: vs.readBufferSizeMB * 1024 * 1024, // è¯»ç¼“å†²åŒºå¤§å°
}

if hasVolume {
    // ä»æ™®é€šå·è¯»å–
    count, err = vs.store.ReadVolumeNeedle(volumeId, n, readOption, onReadSizeFn)
} else if hasEcVolume {
    // ä» EC å·è¯»å–ï¼ˆçº åˆ ç ï¼‰
    count, err = vs.store.ReadEcShardNeedle(volumeId, n, onReadSizeFn)
}

// æ­¥éª¤ 7: éªŒè¯ Cookieï¼ˆå®‰å…¨æ£€æŸ¥ï¼‰
if n.Cookie != cookie {
    // Cookie ä¸åŒ¹é…ï¼Œå¯èƒ½æ˜¯ä¼ªé€ çš„è¯·æ±‚
    NotFound(w)
    return
}

// æ­¥éª¤ 8: è®¾ç½® HTTP ç¼“å­˜ç›¸å…³çš„å“åº”å¤´
if n.LastModified != 0 {
    w.Header().Set("Last-Modified", ...)
    // å¤„ç† If-Modified-Sinceï¼ˆ304 Not Modifiedï¼‰
}
if inm := r.Header.Get("If-None-Match"); inm == "\""+n.Etag()+"\"" {
    // ETag åŒ¹é…ï¼Œè¿”å› 304 Not Modified
    w.WriteHeader(http.StatusNotModified)
    return
}

// æ­¥éª¤ 9: è®¾ç½® Content-Type
mtype := ""
if n.HasMime() {
    mtype = string(n.Mime)  // ä½¿ç”¨å­˜å‚¨çš„ MIME ç±»å‹
}
if filename != "" {
    // æ ¹æ®æ–‡ä»¶æ‰©å±•åæ¨æ–­ MIME ç±»å‹
    mtype = mime.TypeByExtension(ext)
}
w.Header().Set("Content-Type", mtype)

// æ­¥éª¤ 10: å¤„ç†æ–‡ä»¶åï¼ˆContent-Dispositionï¼‰
if filename != "" {
    contentDisposition := "inline"  // é»˜è®¤åœ¨æµè§ˆå™¨ä¸­æ˜¾ç¤º
    if r.FormValue("dl") != "" {
        contentDisposition = "attachment"  // å¼ºåˆ¶ä¸‹è½½
    }
    w.Header().Set("Content-Disposition",
        contentDisposition+`; filename="`+filename+`"`)
}

// æ­¥éª¤ 11: è¿”å›æ–‡ä»¶æ•°æ®
w.Write(n.Data)  // å°†æ–‡ä»¶æ•°æ®å†™å…¥ HTTP å“åº”
```

### ReadMode è¯¦è§£

SeaweedFS æ”¯æŒä¸‰ç§è¯»å–æ¨¡å¼ï¼š

| æ¨¡å¼ | è¯´æ˜ | ä½¿ç”¨åœºæ™¯ |
|------|------|----------|
| **local** | åªè¯»å–æœ¬åœ°å·ï¼Œéæœ¬åœ°è¿”å› 404 | æœ€é«˜æ€§èƒ½ï¼Œé€‚åˆæ•°æ®å·²å‡åŒ€åˆ†å¸ƒ |
| **proxy** | ä»£ç†è¯·æ±‚åˆ°æ‹¥æœ‰æ•°æ®çš„ Volume Server | é€æ˜è®¿é—®ï¼Œå®¢æˆ·ç«¯æ— æ„ŸçŸ¥ |
| **redirect** | è¿”å› 301 é‡å®šå‘åˆ°æ­£ç¡®çš„ Volume Server | å‡å°‘ä»£ç†å¼€é”€ï¼Œå®¢æˆ·ç«¯éœ€å¤„ç†é‡å®šå‘ |

**é…ç½®ç¤ºä¾‹ï¼š**
```bash
# local æ¨¡å¼
weed volume -readMode=local

# proxy æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰
weed volume -readMode=proxy

# redirect æ¨¡å¼
weed volume -readMode=redirect
```

### ä¸‹è½½æµç¨‹å›¾

```
å®¢æˆ·ç«¯
    â”‚
    â–¼
GET /3,01e3b0756f
    â”‚
    â–¼
VolumeServer.GetOrHeadHandler()
    â”‚
    â”œâ”€ 1ï¸âƒ£ è§£æ URL: vid=3, fid=01e3b0756f
    â”‚
    â”œâ”€ 2ï¸âƒ£ JWT è®¤è¯æ£€æŸ¥ï¼ˆå¦‚æœå¯ç”¨ï¼‰
    â”‚
    â”œâ”€ 3ï¸âƒ£ æ£€æŸ¥æœ¬åœ°æ˜¯å¦æœ‰å· 3
    â”‚   â”‚
    â”‚   â”œâ”€ YES: ç»§ç»­æ­¥éª¤ 4
    â”‚   â”‚
    â”‚   â””â”€ NO: æ ¹æ® ReadMode å¤„ç†
    â”‚       â”œâ”€ local â†’ è¿”å› 404
    â”‚       â”œâ”€ proxy â†’ ä»£ç†åˆ°å…¶ä»– Volume Server
    â”‚       â””â”€ redirect â†’ 301 é‡å®šå‘
    â”‚
    â”œâ”€ 4ï¸âƒ£ ä»å­˜å‚¨è¯»å– Needle
    â”‚   â””â”€ vs.store.ReadVolumeNeedle()
    â”‚       â”œâ”€ æŸ¥æ‰¾ç´¢å¼•ï¼ˆfid â†’ offsetï¼‰
    â”‚       â”œâ”€ ä» .dat æ–‡ä»¶è¯»å–æ•°æ®
    â”‚       â””â”€ è§£æ Needle ç»“æ„
    â”‚
    â”œâ”€ 5ï¸âƒ£ éªŒè¯ Cookie
    â”‚
    â”œâ”€ 6ï¸âƒ£ å¤„ç† HTTP ç¼“å­˜
    â”‚   â”œâ”€ Last-Modified / If-Modified-Since
    â”‚   â””â”€ ETag / If-None-Match
    â”‚
    â”œâ”€ 7ï¸âƒ£ è®¾ç½®å“åº”å¤´
    â”‚   â”œâ”€ Content-Type
    â”‚   â”œâ”€ Content-Disposition
    â”‚   â””â”€ Content-Length
    â”‚
    â””â”€ 8ï¸âƒ£ è¿”å›æ–‡ä»¶æ•°æ®
        â””â”€ w.Write(n.Data)
```

---

## ğŸ—‘ï¸ æ–‡ä»¶åˆ é™¤æµç¨‹è¯¦è§£

### æ ¸å¿ƒå¤„ç†å‡½æ•°

**æ–‡ä»¶ä½ç½®ï¼š** `weed/server/volume_server_handlers_write.go`

#### `DeleteHandler()` - åˆ é™¤è¯·æ±‚çš„ä¸»å¤„ç†å‡½æ•°

```go
// DeleteHandler å¤„ç† DELETE è¯·æ±‚ï¼ˆæ–‡ä»¶åˆ é™¤ï¼‰
// API ç¤ºä¾‹ï¼š
//   curl -X DELETE "http://localhost:8080/3,01e3b0756f"
//
// åŠŸèƒ½æµç¨‹ï¼š
// 1. è§£æ URL è·¯å¾„ï¼Œæå– vidã€fid
// 2. æ£€æŸ¥ JWT è®¤è¯ï¼ˆå¦‚æœå¯ç”¨ï¼‰
// 3. æ£€æŸ¥å·æ˜¯å¦åªè¯»
// 4. è°ƒç”¨å­˜å‚¨å¼•æ“æ ‡è®°åˆ é™¤
// 5. è¿”å›åˆ é™¤ç»“æœ
//
// æ³¨æ„ï¼šåˆ é™¤æ˜¯**æ ‡è®°åˆ é™¤**ï¼Œä¸ä¼šç«‹å³å›æ”¶ç£ç›˜ç©ºé—´
func (vs *VolumeServer) DeleteHandler(w http.ResponseWriter, r *http.Request)
```

**å…³é”®å®ç°ï¼š**

```go
// æ­¥éª¤ 1: è§£æ URL
n := new(needle.Needle)
vid, fid, _, _, _ := parseURLPath(r.URL.Path)

volumeId, err := needle.NewVolumeId(vid)
err = n.ParsePath(fid)

// æ­¥éª¤ 2: æ£€æŸ¥å·æ˜¯å¦å­˜åœ¨ä¸”å¯å†™
hasVolume := vs.store.HasVolume(volumeId)
if !hasVolume {
    NotFound(w)
    return
}

// æ­¥éª¤ 3: æ ‡è®°åˆ é™¤ï¼ˆå¹¶éçœŸæ­£åˆ é™¤ï¼‰
// åªæ˜¯åœ¨ç´¢å¼•ä¸­æ ‡è®°ä¸ºå·²åˆ é™¤ï¼Œæ•°æ®ä»åœ¨ .dat æ–‡ä»¶ä¸­
size, err := vs.store.Delete(volumeId, n)

// æ­¥éª¤ 4: è¿”å›ç»“æœ
if err == nil {
    m := make(map[string]uint32)
    m["size"] = size  // è¢«åˆ é™¤æ–‡ä»¶çš„å¤§å°
    writeJsonQuiet(w, r, http.StatusAccepted, m)
} else {
    writeJsonError(w, r, http.StatusInternalServerError, err)
}
```

### æ ‡è®°åˆ é™¤ vs çœŸæ­£åˆ é™¤

SeaweedFS çš„åˆ é™¤åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼š

#### é˜¶æ®µ 1ï¼šæ ‡è®°åˆ é™¤ï¼ˆDELETE è¯·æ±‚ï¼‰

```
æ ‡è®°åˆ é™¤æµç¨‹ï¼š
1. åœ¨ç´¢å¼•ä¸­å°†è¯¥ Needle æ ‡è®°ä¸º "å·²åˆ é™¤"
2. .dat æ–‡ä»¶ä¸­çš„æ•°æ®ä¿æŒä¸å˜
3. åç»­è¯»å–è¯¥æ–‡ä»¶æ—¶ä¼šè¿”å› 404

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         .idx ç´¢å¼•æ–‡ä»¶            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ fid=01e3b0756f â†’ offset=1024    â”‚
â”‚                  size=2048      â”‚
â”‚                  flags=DELETED  â”‚ â† åªæ˜¯æ ‡è®°åˆ é™¤æ ‡å¿—
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         .dat æ•°æ®æ–‡ä»¶            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ...                             â”‚
â”‚ [offset 1024] Needle Data      â”‚ â† æ•°æ®ä»ç„¶å­˜åœ¨
â”‚ ...                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¼˜ç‚¹ï¼š**
- é€Ÿåº¦å¿«ï¼ˆåªä¿®æ”¹ç´¢å¼•ï¼‰
- ä¸éœ€è¦ç§»åŠ¨æ•°æ®
- å¯ä»¥æ¢å¤ï¼ˆè®¾ç½® readDeleted=trueï¼‰

**ç¼ºç‚¹ï¼š**
- ä¸é‡Šæ”¾ç£ç›˜ç©ºé—´
- éœ€è¦å®šæœŸå‹ç¼©ï¼ˆVacuumï¼‰

#### é˜¶æ®µ 2ï¼šVacuum å‹ç¼©ï¼ˆå›æ”¶ç©ºé—´ï¼‰

```bash
# è§¦å‘ Vacuum å‹ç¼©
curl "http://localhost:9333/vol/vacuum?garbageThreshold=0.3"
```

**Vacuum æµç¨‹ï¼š**

```
1. éå†å·ï¼Œè®¡ç®—åƒåœ¾æ¯”ä¾‹
   åƒåœ¾æ¯”ä¾‹ = å·²åˆ é™¤æ•°æ®å¤§å° / æ€»æ•°æ®å¤§å°

2. å¦‚æœåƒåœ¾æ¯”ä¾‹ > garbageThresholdï¼ˆé»˜è®¤ 0.3ï¼‰
   â”œâ”€ åˆ›å»ºæ–°å·æ–‡ä»¶ï¼ˆ.dat å’Œ .idxï¼‰
   â”œâ”€ å¤åˆ¶æ‰€æœ‰**æœªåˆ é™¤**çš„ Needle åˆ°æ–°å·
   â”œâ”€ åˆ é™¤æ—§å·æ–‡ä»¶
   â””â”€ é‡å‘½åæ–°å·æ–‡ä»¶

3. æ›´æ–° Master çš„å·ä¿¡æ¯
```

**ç¤ºä¾‹ï¼š**

```
åŸå·ï¼ˆ10GBï¼‰:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Needle A (2GB) - Active  â”‚
â”‚ Needle B (3GB) - Deleted â”‚ â† åƒåœ¾
â”‚ Needle C (2GB) - Active  â”‚
â”‚ Needle D (1GB) - Deleted â”‚ â† åƒåœ¾
â”‚ Needle E (2GB) - Active  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
åƒåœ¾æ¯”ä¾‹ = (3GB + 1GB) / 10GB = 40% > 30%

Vacuum åï¼ˆ6GBï¼‰:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Needle A (2GB) - Active  â”‚
â”‚ Needle C (2GB) - Active  â”‚
â”‚ Needle E (2GB) - Active  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
å›æ”¶äº† 4GB ç©ºé—´
```

### åˆ é™¤æµç¨‹å›¾

```
å®¢æˆ·ç«¯ DELETE /3,01e3b0756f
    â”‚
    â–¼
VolumeServer.DeleteHandler()
    â”‚
    â”œâ”€ 1ï¸âƒ£ è§£æ fid
    â”‚
    â”œâ”€ 2ï¸âƒ£ æ£€æŸ¥å·æ˜¯å¦å­˜åœ¨
    â”‚
    â”œâ”€ 3ï¸âƒ£ è°ƒç”¨ store.Delete()
    â”‚   â”‚
    â”‚   â”œâ”€ æŸ¥æ‰¾ç´¢å¼•æ‰¾åˆ° offset
    â”‚   â”‚
    â”‚   â”œâ”€ åœ¨ç´¢å¼•ä¸­æ ‡è®° DELETED
    â”‚   â”‚   ï¼ˆ.idx æ–‡ä»¶æ›´æ–°ï¼‰
    â”‚   â”‚
    â”‚   â””â”€ .dat æ–‡ä»¶ä¸å˜
    â”‚
    â””â”€ 4ï¸âƒ£ è¿”å› 202 Accepted
        {
          "size": 2048
        }

ç¨å Vacuum å‹ç¼©
    â”‚
    â”œâ”€ Master è§¦å‘
    â”‚   curl /vol/vacuum
    â”‚
    â”œâ”€ éå†æ‰€æœ‰å·
    â”‚
    â”œâ”€ è®¡ç®—åƒåœ¾æ¯”ä¾‹
    â”‚   if (deleted_size / total_size) > threshold
    â”‚
    â”œâ”€ åˆ›å»ºæ–°å·
    â”‚   â”œâ”€ new_3.dat
    â”‚   â””â”€ new_3.idx
    â”‚
    â”œâ”€ å¤åˆ¶æœªåˆ é™¤çš„ Needle
    â”‚   ï¼ˆåªå¤åˆ¶ Active çŠ¶æ€çš„ï¼‰
    â”‚
    â”œâ”€ æ›¿æ¢æ—§å·
    â”‚   â”œâ”€ rm 3.dat 3.idx
    â”‚   â””â”€ mv new_3.dat 3.dat
    â”‚       mv new_3.idx 3.idx
    â”‚
    â””â”€ é‡Šæ”¾ç£ç›˜ç©ºé—´ âœ“
```

---

## ğŸ’¾ å­˜å‚¨å¼•æ“æ ¸å¿ƒè¯¦è§£

### Needle æ•°æ®ç»“æ„

**æ–‡ä»¶ä½ç½®ï¼š** `weed/storage/needle/needle.go`

Needle æ˜¯ SeaweedFS å­˜å‚¨æ–‡ä»¶çš„åŸºæœ¬å•ä½ï¼š

```go
// Needle ç»“æ„ï¼ˆç®€åŒ–ç‰ˆï¼‰
type Needle struct {
    // Headerï¼ˆæ–‡ä»¶å¤´ï¼‰
    Cookie   Cookie   // 32ä½éšæœºæ•°ï¼Œç”¨äºéªŒè¯è¯·æ±‚çš„åˆæ³•æ€§
    Id       NeedleId // 64ä½æ–‡ä»¶IDï¼ˆä» fid è§£æï¼‰
    Size     uint32   // æ–‡ä»¶æ€»å¤§å°ï¼ˆåŒ…æ‹¬å…ƒæ•°æ®ï¼‰

    // Dataï¼ˆæ•°æ®éƒ¨åˆ†ï¼‰
    Data     []byte   // å®é™…çš„æ–‡ä»¶å†…å®¹
    Flags    byte     // æ ‡å¿—ä½ï¼ˆæ˜¯å¦åˆ é™¤ã€æ˜¯å¦å‹ç¼©ç­‰ï¼‰

    // Metadataï¼ˆå…ƒæ•°æ®ï¼‰
    NameSize  uint8   // æ–‡ä»¶åé•¿åº¦
    Name      []byte  // æ–‡ä»¶å
    MimeSize  uint8   // MIME ç±»å‹é•¿åº¦
    Mime      []byte  // MIME ç±»å‹ï¼ˆå¦‚ "image/jpeg"ï¼‰

    // Optional Fieldsï¼ˆå¯é€‰å­—æ®µï¼‰
    LastModified uint64  // æœ€åä¿®æ”¹æ—¶é—´ï¼ˆUnix æ—¶é—´æˆ³ï¼‰
    Ttl          *TTL    // Time To Liveï¼ˆè¿‡æœŸæ—¶é—´ï¼‰
    Checksum     CRC     // æ ¡éªŒå’Œï¼ˆç”¨äºæ•°æ®å®Œæ•´æ€§éªŒè¯ï¼‰

    // Pairsï¼ˆè‡ªå®šä¹‰é”®å€¼å¯¹ï¼‰
    Pairs []byte  // JSON æ ¼å¼çš„è‡ªå®šä¹‰å…ƒæ•°æ®
}
```

**åœ¨ç£ç›˜ä¸Šçš„å¸ƒå±€ï¼š**

```
.dat æ–‡ä»¶ä¸­çš„ Needle æ ¼å¼ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Cookie (4 bytes)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Id (8 bytes)                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Size (4 bytes)                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Data (variable)                               â”‚
â”‚  ...                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Flags (1 byte)                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  NameSize (1 byte) | Name (variable)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  MimeSize (1 byte) | Mime (variable)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  LastModified (8 bytes)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Checksum (4 bytes)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Total size = 16 + Size (aligned to 8 bytes)
```

### Volume ç»“æ„

**æ–‡ä»¶ä½ç½®ï¼š** `weed/storage/volume.go`

Volume æ˜¯å·çš„æ ¸å¿ƒå®ç°ï¼š

```go
// Volume å·ç»“æ„
type Volume struct {
    Id            VolumeId        // å· IDï¼ˆå¦‚ 3ï¼‰
    dir           string          // å­˜å‚¨ç›®å½•ï¼ˆå¦‚ /dataï¼‰
    Collection    string          // Collection åç§°

    // æ–‡ä»¶å¥æŸ„
    dataFile      *os.File        // .dat æ–‡ä»¶å¥æŸ„ï¼ˆå­˜å‚¨å®é™…æ•°æ®ï¼‰
    nm            NeedleMapper    // ç´¢å¼•æ˜ å°„å™¨ï¼ˆ.idx æ–‡ä»¶ï¼‰

    // å…ƒä¿¡æ¯
    ReplicaPlacement *ReplicaPlacement // å¤åˆ¶ç­–ç•¥ï¼ˆå¦‚ "001"ï¼‰
    Ttl              *needle.TTL       // é»˜è®¤ TTL
    lastModifiedTsSeconds uint64       // æœ€åä¿®æ”¹æ—¶é—´

    // çŠ¶æ€
    readOnly      bool            // æ˜¯å¦åªè¯»
    noWriteCanDelete bool         // æ˜¯å¦ç¦æ­¢å†™å…¥ï¼ˆä½†å…è®¸åˆ é™¤ï¼‰

    // ç»Ÿè®¡ä¿¡æ¯
    lastAppendAtNs uint64         // æœ€åè¿½åŠ æ—¶é—´ï¼ˆçº³ç§’ï¼‰
    fileSize       int64          // .dat æ–‡ä»¶å¤§å°
}
```

**å·æ–‡ä»¶ç»„æˆï¼š**

```
å· ID = 3 çš„æ–‡ä»¶ï¼š

/data/
  â”œâ”€ 3.dat        â† æ•°æ®æ–‡ä»¶ï¼ˆå­˜å‚¨æ‰€æœ‰ Needleï¼‰
  â”œâ”€ 3.idx        â† ç´¢å¼•æ–‡ä»¶ï¼ˆNeedleId â†’ Offset æ˜ å°„ï¼‰
  â”œâ”€ 3.cpd        â† Compaction ä¸´æ—¶æ–‡ä»¶ï¼ˆå‹ç¼©æ—¶ä½¿ç”¨ï¼‰
  â””â”€ 3.vif        â† Volume Info æ–‡ä»¶ï¼ˆå·çš„å…ƒä¿¡æ¯ï¼‰
```

### ç´¢å¼•æœºåˆ¶ï¼ˆNeedleMapperï¼‰

SeaweedFS æ”¯æŒå¤šç§ç´¢å¼•å®ç°ï¼š

#### 1. å†…å­˜ç´¢å¼•ï¼ˆMemDbï¼‰

```go
// æœ€å¿«ï¼Œä½†å ç”¨å†…å­˜å¤§
// æ¯ä¸ª Needle å ç”¨çº¦ 16 å­—èŠ‚å†…å­˜
// 1 äº¿ä¸ªæ–‡ä»¶ â‰ˆ 1.6GB å†…å­˜

type NeedleMap struct {
    m map[NeedleId]NeedleValue  // å†…å­˜å“ˆå¸Œè¡¨
}

type NeedleValue struct {
    Offset types.Offset  // åœ¨ .dat æ–‡ä»¶ä¸­çš„åç§»é‡
    Size   types.Size    // æ–‡ä»¶å¤§å°
}
```

**æŸ¥æ‰¾æµç¨‹ï¼š**
```
1. é€šè¿‡ NeedleId åœ¨å“ˆå¸Œè¡¨ä¸­æŸ¥æ‰¾
2. è·å– Offset
3. ç›´æ¥è·³è½¬åˆ° .dat æ–‡ä»¶çš„å¯¹åº”ä½ç½®è¯»å–
```

#### 2. LevelDB ç´¢å¼•

```go
// èŠ‚çœå†…å­˜ï¼Œä½†é€Ÿåº¦ç¨æ…¢
// ç´¢å¼•æ•°æ®å­˜å‚¨åœ¨ç£ç›˜çš„ LevelDB ä¸­
// é€‚åˆå¤§å®¹é‡å·ï¼ˆæ•°äº¿ä¸ªæ–‡ä»¶ï¼‰

type LevelDbNeedleMap struct {
    db *leveldb.DB  // LevelDB æ•°æ®åº“
    mapMetric *mapMetric
}
```

**æŸ¥æ‰¾æµç¨‹ï¼š**
```
1. é€šè¿‡ NeedleId åœ¨ LevelDB ä¸­æŸ¥æ‰¾
2. è·å– Offsetï¼ˆå¯èƒ½éœ€è¦ç£ç›˜ IOï¼‰
3. è·³è½¬åˆ° .dat æ–‡ä»¶è¯»å–
```

**ç´¢å¼•ç±»å‹å¯¹æ¯”ï¼š**

| ç´¢å¼•ç±»å‹ | å†…å­˜å ç”¨ | æŸ¥æ‰¾é€Ÿåº¦ | é€‚ç”¨åœºæ™¯ |
|---------|---------|---------|---------|
| memory | é«˜ï¼ˆ16B/æ–‡ä»¶ï¼‰ | æå¿«ï¼ˆO(1)ï¼‰ | å°è§„æ¨¡å·ï¼ˆ< 1000ä¸‡æ–‡ä»¶ï¼‰ |
| leveldb | ä½ | å¿«ï¼ˆéœ€è¦ç£ç›˜IOï¼‰ | å¤§è§„æ¨¡å·ï¼ˆ> 1000ä¸‡æ–‡ä»¶ï¼‰ |
| leveldbMedium | ä¸­ç­‰ï¼ˆç¼“å­˜ï¼‰ | è¾ƒå¿« | å¹³è¡¡é€‰æ‹© |
| leveldbLarge | ä½ | ä¸­ç­‰ | è¶…å¤§è§„æ¨¡ |

### è¯»å– Needle çš„å®Œæ•´æµç¨‹

```
ReadVolumeNeedle(volumeId, needle, readOption)
    â”‚
    â”œâ”€ 1ï¸âƒ£ ä»ç´¢å¼•æŸ¥æ‰¾ Offset
    â”‚   â”‚
    â”‚   â”œâ”€ å†…å­˜ç´¢å¼•: map[NeedleId] â†’ Offset
    â”‚   â””â”€ LevelDBç´¢å¼•: db.Get(NeedleId) â†’ Offset
    â”‚
    â”œâ”€ 2ï¸âƒ£ æ‰“å¼€ .dat æ–‡ä»¶
    â”‚   volume.dataFile.Seek(offset, 0)
    â”‚
    â”œâ”€ 3ï¸âƒ£ è¯»å– Needle Header
    â”‚   â”œâ”€ Cookie (4B)
    â”‚   â”œâ”€ Id (8B)
    â”‚   â””â”€ Size (4B)
    â”‚
    â”œâ”€ 4ï¸âƒ£ è¯»å– Needle Data
    â”‚   read(needle.Data, size)
    â”‚
    â”œâ”€ 5ï¸âƒ£ è¯»å– Needle Footer
    â”‚   â”œâ”€ Flags (1B) â† æ£€æŸ¥æ˜¯å¦åˆ é™¤
    â”‚   â”œâ”€ Name
    â”‚   â”œâ”€ Mime
    â”‚   â”œâ”€ LastModified
    â”‚   â””â”€ Checksum
    â”‚
    â”œâ”€ 6ï¸âƒ£ éªŒè¯æ•°æ®å®Œæ•´æ€§
    â”‚   if CalculateChecksum(data) != needle.Checksum {
    â”‚       return ErrorCorrupted
    â”‚   }
    â”‚
    â””â”€ 7ï¸âƒ£ è¿”å› Needle
```

### SuperBlockï¼ˆå·çš„å…ƒä¿¡æ¯ï¼‰

æ¯ä¸ªå·æ–‡ä»¶ï¼ˆ.datï¼‰çš„å¼€å¤´æœ‰ä¸€ä¸ª SuperBlockï¼š

```go
type SuperBlock struct {
    version          Version         // ç‰ˆæœ¬å·
    ReplicaPlacement *ReplicaPlacement // å¤åˆ¶ç­–ç•¥
    Ttl              *needle.TTL     // é»˜è®¤ TTL
    CompactionRevision uint16        // å‹ç¼©ç‰ˆæœ¬å·
}
```

**åœ¨ .dat æ–‡ä»¶ä¸­çš„ä½ç½®ï¼š**

```
.dat æ–‡ä»¶ç»“æ„ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SuperBlock (8 bytes)               â”‚ â† å·çš„å…ƒä¿¡æ¯
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Needle 1                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Needle 2                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Needle 3                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ...                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ å­¦ä¹ å»ºè®®

### é˜¶æ®µ 1ï¼šç†è§£æ•´ä½“æµç¨‹ï¼ˆå½“å‰é˜¶æ®µï¼‰

**å·²å®Œæˆçš„å­¦ä¹ ï¼š**
- âœ… æ–‡ä»¶ä¸Šä¼ æµç¨‹
- âœ… æ–‡ä»¶ä¸‹è½½æµç¨‹ï¼ˆæœ¬æ–‡æ¡£ï¼‰
- âœ… æ–‡ä»¶åˆ é™¤æµç¨‹ï¼ˆæœ¬æ–‡æ¡£ï¼‰
- âœ… å­˜å‚¨å¼•æ“åŸºç¡€ï¼ˆæœ¬æ–‡æ¡£ï¼‰

**å®è·µå»ºè®®ï¼š**

```bash
# 1. å¯åŠ¨ SeaweedFSï¼ˆè¯¦ç»†æ—¥å¿—ï¼‰
weed server -dir=/tmp/data -v=4

# 2. ä¸Šä¼ æ–‡ä»¶
curl -F file=@test.jpg "http://localhost:9333/submit" | jq .
# è®°å½•è¿”å›çš„ fidï¼Œå¦‚ "3,01e3b0756f"

# 3. ä¸‹è½½æ–‡ä»¶
curl "http://localhost:8080/3,01e3b0756f" -o downloaded.jpg

# 4. æŸ¥çœ‹å·æ–‡ä»¶
ls -lh /tmp/data/
# ä½ ä¼šçœ‹åˆ°ï¼š
#   3.dat  - æ•°æ®æ–‡ä»¶
#   3.idx  - ç´¢å¼•æ–‡ä»¶

# 5. åˆ é™¤æ–‡ä»¶
curl -X DELETE "http://localhost:8080/3,01e3b0756f"

# 6. å†æ¬¡ä¸‹è½½ï¼ˆä¼šè¿”å› 404ï¼‰
curl "http://localhost:8080/3,01e3b0756f"

# 7. æŸ¥çœ‹å·å¤§å°ï¼ˆæœªå˜åŒ–ï¼Œå› ä¸ºåªæ˜¯æ ‡è®°åˆ é™¤ï¼‰
ls -lh /tmp/data/3.dat

# 8. è§¦å‘ Vacuum å‹ç¼©
curl "http://localhost:9333/vol/vacuum?garbageThreshold=0.01"

# 9. å†æ¬¡æŸ¥çœ‹å·å¤§å°ï¼ˆåº”è¯¥å˜å°äº†ï¼‰
ls -lh /tmp/data/3.dat
```

### é˜¶æ®µ 2ï¼šæ·±å…¥æºç è°ƒè¯•

**æ¨èè°ƒè¯•è·¯å¾„ï¼š**

1. **ä¸‹è½½æµç¨‹ï¼š**
   ```
   weed/server/volume_server_handlers_read.go:136
   â†’ GetOrHeadHandler()
   â†’ vs.store.ReadVolumeNeedle()
   â†’ weed/storage/volume.go
   â†’ weed/storage/needle_read.go
   ```

2. **åˆ é™¤æµç¨‹ï¼š**
   ```
   weed/server/volume_server_handlers_write.go
   â†’ DeleteHandler()
   â†’ vs.store.Delete()
   â†’ weed/storage/volume.go
   â†’ needle mapper æ ‡è®°åˆ é™¤
   ```

3. **Vacuum æµç¨‹ï¼š**
   ```
   weed/topology/topology.go
   â†’ Vacuum()
   â†’ weed/storage/volume.go
   â†’ Compact()
   â†’ åˆ›å»ºæ–°å·ï¼Œå¤åˆ¶æœªåˆ é™¤çš„ Needle
   ```

### é˜¶æ®µ 3ï¼šæ€§èƒ½ä¼˜åŒ–ç†è§£

**å…³é”®ä¼˜åŒ–ç‚¹ï¼š**

1. **ç´¢å¼•é€‰æ‹©ï¼š**
   - å°å·ï¼ˆ< 1000ä¸‡æ–‡ä»¶ï¼‰ï¼šä½¿ç”¨ memory ç´¢å¼•
   - å¤§å·ï¼ˆ> 1000ä¸‡æ–‡ä»¶ï¼‰ï¼šä½¿ç”¨ leveldb ç´¢å¼•

2. **è¯»å–æ¨¡å¼ï¼š**
   - æ•°æ®å±€éƒ¨æ€§å¥½ï¼šlocal æ¨¡å¼
   - éœ€è¦é€æ˜è®¿é—®ï¼šproxy æ¨¡å¼
   - å®¢æˆ·ç«¯å¯å¤„ç†é‡å®šå‘ï¼šredirect æ¨¡å¼

3. **Vacuum æ—¶æœºï¼š**
   - garbageThreshold é»˜è®¤ 0.3ï¼ˆ30%ï¼‰
   - å¤ªå°ï¼šé¢‘ç¹å‹ç¼©ï¼Œå½±å“æ€§èƒ½
   - å¤ªå¤§ï¼šæµªè´¹ç£ç›˜ç©ºé—´

4. **å¹¶å‘æ§åˆ¶ï¼š**
   - concurrentDownloadLimitMBï¼šé™åˆ¶å¹¶å‘ä¸‹è½½å†…å­˜
   - hasSlowReadï¼šé˜²æ­¢æ…¢è¯»é˜»å¡å…¶ä»–è¯·æ±‚

### é˜¶æ®µ 4ï¼šé«˜çº§ç‰¹æ€§

**ä¸‹ä¸€æ­¥å­¦ä¹ æ–¹å‘ï¼š**

1. **çº åˆ ç ï¼ˆErasure Codingï¼‰ï¼š**
   - ç”¨äºå†·æ•°æ®å­˜å‚¨
   - æ›´é«˜çš„ç©ºé—´åˆ©ç”¨ç‡
   - æ›´å¤æ‚çš„è¯»å†™æµç¨‹

2. **å¤åˆ¶æœºåˆ¶ï¼ˆReplicationï¼‰ï¼š**
   - æ•°æ®å†—ä½™å’Œé«˜å¯ç”¨
   - è·¨æ•°æ®ä¸­å¿ƒå¤åˆ¶
   - ä¸€è‡´æ€§ä¿è¯

3. **å‹ç¼©å’Œå»é‡ï¼š**
   - æ–‡ä»¶å‹ç¼©ï¼ˆGzipï¼‰
   - å†…å®¹å¯»å€å»é‡

---

## ğŸ“š æºç æ–‡ä»¶ç´¢å¼•

### ä¸‹è½½ç›¸å…³
- `weed/server/volume_server_handlers_read.go` - HTTP ä¸‹è½½å¤„ç†
- `weed/storage/volume.go` - å·è¯»å–æ ¸å¿ƒ
- `weed/storage/needle_read.go` - Needle è¯»å–
- `weed/storage/needle_map.go` - å†…å­˜ç´¢å¼•
- `weed/storage/needle_map_leveldb.go` - LevelDB ç´¢å¼•

### åˆ é™¤ç›¸å…³
- `weed/server/volume_server_handlers_write.go` - HTTP åˆ é™¤å¤„ç†
- `weed/storage/volume.go` - å·åˆ é™¤æ ¸å¿ƒ
- `weed/storage/needle.go` - Needle æ ‡è®°åˆ é™¤
- `weed/topology/topology.go` - Vacuum è§¦å‘
- `weed/storage/volume_vacuum.go` - å‹ç¼©å®ç°

### å­˜å‚¨å¼•æ“
- `weed/storage/needle/needle.go` - Needle æ•°æ®ç»“æ„
- `weed/storage/volume.go` - Volume æ ¸å¿ƒ
- `weed/storage/store.go` - Storeï¼ˆç®¡ç†å¤šä¸ªå·ï¼‰
- `weed/storage/super_block.go` - SuperBlock
- `weed/storage/needle_map*.go` - å„ç§ç´¢å¼•å®ç°

---

## ğŸ”§ è°ƒè¯•æŠ€å·§

### 1. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—

```bash
# å¯åŠ¨æ—¶è®¾ç½®æ—¥å¿—çº§åˆ«
weed server -dir=/tmp/data -v=4
# v=0: ERROR
# v=1: WARNING
# v=2: INFO
# v=3: DEBUG
# v=4: TRACE
```

### 2. æŸ¥çœ‹å·çŠ¶æ€

```bash
# æŸ¥çœ‹æ‰€æœ‰å·
curl "http://localhost:9333/dir/status?pretty=y"

# æŸ¥çœ‹ç‰¹å®š Volume Server çš„å·
curl "http://localhost:8080/status?pretty=y"
```

### 3. æŸ¥çœ‹æ–‡ä»¶å…ƒæ•°æ®

```bash
# è·å–æ–‡ä»¶å¤´ä¿¡æ¯
curl -I "http://localhost:8080/3,01e3b0756f"
```

### 4. å¼ºåˆ¶è¯»å–å·²åˆ é™¤æ–‡ä»¶

```bash
# ç”¨äºè°ƒè¯•å’Œæ¢å¤
curl "http://localhost:8080/3,01e3b0756f?readDeleted=true"
```

---

## æ€»ç»“

é€šè¿‡æœ¬æ–‡æ¡£ï¼Œä½ åº”è¯¥å·²ç»æŒæ¡äº†ï¼š

1. âœ… æ–‡ä»¶ä¸‹è½½çš„å®Œæ•´æµç¨‹ï¼ˆä» HTTP è¯·æ±‚åˆ°ç£ç›˜è¯»å–ï¼‰
2. âœ… æ–‡ä»¶åˆ é™¤çš„ä¸¤é˜¶æ®µæœºåˆ¶ï¼ˆæ ‡è®°åˆ é™¤ + Vacuumï¼‰
3. âœ… Needle æ•°æ®ç»“æ„ï¼ˆSeaweedFS çš„å­˜å‚¨å•ä½ï¼‰
4. âœ… Volume å’Œç´¢å¼•æœºåˆ¶ï¼ˆå†…å­˜ vs LevelDBï¼‰
5. âœ… æ€§èƒ½ä¼˜åŒ–çš„å…³é”®å‚æ•°

å»ºè®®ç»“åˆ[ä¸Šä¼ æµç¨‹æ–‡æ¡£](LEARNING_GUIDE_API_FLOW.md)ä¸€èµ·å­¦ä¹ ï¼Œå½¢æˆå®Œæ•´çš„çŸ¥è¯†ä½“ç³»ï¼
